<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta 
    name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <meta 
    http-equiv="X-UA-Compatible" 
    content="ie=edge">
  <meta 
    name="theme-color" 
    content="#fff" 
    id="theme-color">
  <meta 
    name="description" 
    content="Hexo">
  <link 
    rel="icon" 
    href="/">
  <title>解释器模式</title>
  
    
      <meta 
        property="og:title" 
        content="解释器模式">
    
    
      <meta 
        property="og:url" 
        content="https://extremelys.github.io/2023/03/20/InterpreterPattern/index.html">
    
    
      <meta 
        property="og:img" 
        content="https://img.songhn.com/img/Y67gdd.png">
    
    
    
      <meta 
        property="og:type" 
        content="article">
      <meta 
        property="og:article:published_time" 
        content="2023-03-20">
      <meta 
        property="og:article:modified_time" 
        content="2023-03-21">
      <meta 
        property="og:article:author" 
        content="简单且极端">
      
        
          <meta 
            property="og:article:tag" 
            content="设计模式">
        
          <meta 
            property="og:article:tag" 
            content="用类来表示">
        
      
    
  
  
  <link rel="preload" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" as="style" >
  <link rel="preload" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" as="style" >
  <link rel="preload" href="/css/main.css" as="style" >
  
  <link rel="modulepreload" href="//instant.page/5.1.0">
  
  <link rel="stylesheet" href="/css/main.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css">
  
  
  
    <link rel="stylesheet" href="/js/lib/lightbox/baguetteBox.min.css">
  
  <script>
    function loadScript(url, cb) {
      var script = document.createElement('script');
      script.src = url;
      if (cb) script.onload = cb;
      script.async = true;
      document.body.appendChild(script);
    }
    function loadCSS(href, data, attr) {
      var sheet = document.createElement('link');
      sheet.ref = 'stylesheet';
      sheet.href = href;
      sheet.dataset[data] = attr;
      document.head.appendChild(sheet);
    }
    function changeCSS(cssFile, data, attr) {
      var oldlink = document.querySelector(data);
      var newlink = document.createElement("link");
      newlink.setAttribute("rel", "stylesheet");
      newlink.setAttribute("href", cssFile);
      newlink.dataset.prism = attr;
      document.head.replaceChild(newlink, oldlink);
    }
  </script>
  
    
      
      
      
      
        
        
        
        <script>
          function prismThemeChange() {
            if(document.getElementById('theme-color').dataset.mode === 'dark') {
              if(document.querySelector('[data-prism]')) {
                changeCSS('/js/lib/prism/prism-tomorrow.min.css', '[data-prism]', 'prism-tomorrow');
              } else {
                loadCSS('/js/lib/prism/prism-tomorrow.min.css', 'prism', 'prism-tomorrow');
              }
            } else {
              if(document.querySelector('[data-prism]')) {
                changeCSS('/js/lib/prism/prism.min.css', '[data-prism]', 'prism');
              } else {
                loadCSS('/js/lib/prism/prism.min.css', 'prism', 'prism');
              }
            }
          }
          prismThemeChange()
        </script>
      
      
        
        <link rel="stylesheet" href="/js/lib/prism/prism-line-numbers.min.css">
      
    
  
  <script>
    // control reverse button
    var reverseDarkList = {
      dark: 'light',
      light: 'dark'
    };
    var themeColor = {
      dark: '#1c1c1e',
      light: '#fff'
    }
    // get the data of css prefers-color-scheme
    var getCssMediaQuery = function() {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    };
    // reverse current darkmode setting function
    var reverseDarkModeSetting = function() {
      var setting = localStorage.getItem('user-color-scheme');
      if(reverseDarkList[setting]) {
        setting = reverseDarkList[setting];
      } else if(setting === null) {
        setting = reverseDarkList[getCssMediaQuery()];
      } else {
        return;
      }
      localStorage.setItem('user-color-scheme', setting);
      return setting;
    };
    // apply current darkmode setting
  </script>
  
    <script>
      var setDarkmode = function(mode) {
      var setting = mode || localStorage.getItem('user-color-scheme');
      if(setting === getCssMediaQuery()) {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
        prismThemeChange();
      } else if(reverseDarkList[setting]) {
        document.documentElement.setAttribute('data-user-color-scheme', setting);
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
        prismThemeChange();
      } else {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[getCssMediaQuery()];
        document.getElementById('theme-color').dataset.mode = getCssMediaQuery();
        prismThemeChange();
      }
    };
    setDarkmode();
    </script>
  
  
  
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.js" as="script">
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lozad.min.js" as="script">
  
  
  
  
  
  
<meta name="generator" content="Hexo 6.2.0"></head>

  <body>
    <div class="wrapper">
       
      <nav class="navbar">
  <div class="navbar-logo">
    <a class="navbar-logo-main" href="/">
      
      <span class="navbar-logo-dsc">简单且极端</span>
      </a>
  </div>
  <div class="navbar-menu">
    
      <a 
        href="/" 
        class="navbar-menu-item">
        
          首页
        
      </a>
    
      <a 
        href="/archives" 
        class="navbar-menu-item">
        
          归档
        
      </a>
    
      <a 
        href="/tags" 
        class="navbar-menu-item">
        
          标签
        
      </a>
    
      <a 
        href="/categories" 
        class="navbar-menu-item">
        
          分类
        
      </a>
    
    <button 
      class="navbar-menu-item darknavbar navbar-menu-btn" 
      aria-label="Toggle dark mode"
      id="dark">
      <i class="iconfont icon-weather"></i>
    </button>
    <button 
      class="navbar-menu-item searchnavbar navbar-menu-btn" 
      aria-label="Toggle search"
      id="search">
      <!-- <i 
        class="iconfont icon-search" 
        style="font-size: 1.2rem; font-weight: 400;">
      </i> -->
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img"
        class="iconify iconify--ion" width="28" height="28" preserveAspectRatio="xMidYMid meet" viewBox="0 0 512 512">
        <path fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"
          d="M256 80a176 176 0 1 0 176 176A176 176 0 0 0 256 80Z"></path>
        <path fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"
          d="M232 160a72 72 0 1 0 72 72a72 72 0 0 0-72-72Z"></path>
        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="28"
          d="M283.64 283.64L336 336"></path>
      </svg>
    </button>
  </div>
</nav> 
      
      <div 
        id="local-search" 
        style="display: none">
        <input
          class="navbar-menu-item"
          id="search-input"
          placeholder="请输入搜索内容..." />
        <div id="search-content"></div>
      </div>
      
      <div class="section-wrap">
        <div class="container">
          <div class="columns">
            <aside class="left-column">
              
              <div class="card card-author">
                
  <img 
    src="https://img.songhn.com/img/Y67gdd.png" 
    class="author-img"
    width="88"
    height="88"
    alt="author avatar">

<p class="author-name">简单且极端</p>
<p class="author-description">只做能力范围之内的事，<br/>那么你将永远不会进步。</p>
<div class="author-message">
  <a 
    class="author-posts-count" 
    href="/archives">
    <span>23</span>
    <span>文章</span>
  </a>
  <a 
    class="author-categories-count" 
    href="/categories">
    <span>1</span>
    <span>分类</span>
  </a>
  <a 
    class="author-tags-count" 
    href="/tags">
    <span>11</span>
    <span>标签</span>
  </a>
</div>

              </div>
               <div class="sticky-tablet">
  
  
    <article class="display-when-two-columns spacer">
      <div class="card card-content toc-card">
        <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Interpreter%E6%A8%A1%E5%BC%8F%EF%BC%88%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">Interpreter模式（解释器模式）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80"><span class="toc-text">迷你语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-text">迷你语言的命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E7%A4%BA%E4%BE%8B"><span class="toc-text">迷你语言程序示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-text">迷你语言的语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E9%9D%9E%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">终结符表达式与非终结符表达式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E7%B1%BB%E5%9B%BE"><span class="toc-text">示例类图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E7%A8%8B%E5%BA%8F"><span class="toc-text">示例程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Node%E7%B1%BB"><span class="toc-text">Node类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProgramNode%E7%B1%BB"><span class="toc-text">ProgramNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CommandListNode%E7%B1%BB"><span class="toc-text">CommandListNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CommandNode%E7%B1%BB"><span class="toc-text">CommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RepeatCommandNode%E7%B1%BB"><span class="toc-text">RepeatCommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PrimitiveCommandNode%E7%B1%BB"><span class="toc-text">PrimitiveCommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Context%E7%B1%BB"><span class="toc-text">Context类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ParseException%E7%B1%BB"><span class="toc-text">ParseException类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Main%E7%B1%BB"><span class="toc-text">Main类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#program-txt"><span class="toc-text">program.txt</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interpreter%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E7%99%BB%E5%9C%BA%E8%A7%92%E8%89%B2"><span class="toc-text">Interpreter模式中的登场角色</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AbstractExpression%EF%BC%88%E6%8A%BD%E8%B1%A1%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">AbstractExpression（抽象表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TerminalExpression%EF%BC%88%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">TerminalExpression（终结符表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NonterminalExpression%EF%BC%88%E9%9D%9E%E7%BB%88%E7%BB%93%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">NonterminalExpression（非终结表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Context%EF%BC%88%E6%96%87%E8%84%89%E3%80%81%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%89"><span class="toc-text">Context（文脉、上下文）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Client%EF%BC%88%E8%AF%B7%E6%B1%82%E8%80%85%EF%BC%89"><span class="toc-text">Client（请求者）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InterPreter%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%B1%BB%E5%9B%BE"><span class="toc-text">InterPreter模式的类图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%93%E5%B1%95%E6%80%9D%E8%B7%AF%E8%A6%81%E7%82%B9"><span class="toc-text">拓展思路要点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%98%E6%9C%89%E5%85%B6%E4%BB%96%E5%93%AA%E4%BA%9B%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80"><span class="toc-text">还有其他哪些迷你语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BF%87%E6%A0%87%E8%AE%B0%E8%BF%98%E6%98%AF%E8%AF%BB%E5%8F%96%E6%A0%87%E8%AE%B0"><span class="toc-text">跳过标记还是读取标记</span></a></li></ol></li></ol></li></ol>
      </div>
    </article>
  
  
  <article class="card card-content categories-widget">
    <div class="categories-card">
  <div class="categories-header">
    <i 
      class="iconfont icon-fenlei" 
      style="padding-right: 2px;">
    </i>分类
  </div>
  <div class="categories-list">
    
      <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
        <div class="categories-list-item">
          设计模式
          <span class="categories-list-item-badge">23</span>
        </div>
      </a>
    
  </div>
</div>
  </article>
  
  <article class="card card-content tags-widget">
    <div class="tags-card">
  <div class="tags-header">
    <i 
      class="iconfont icon-biaoqian" 
      style="padding-right: 2px;">
    </i>热门标签
  </div>
  <div class="tags-list">
    
      <a 
        href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" 
        title="设计模式">
        <div class="tags-list-item">设计模式</div>
      </a>
    
      <a 
        href="/tags/%E7%94%9F%E6%88%90%E5%AE%9E%E4%BE%8B/" 
        title="生成实例">
        <div class="tags-list-item">生成实例</div>
      </a>
    
      <a 
        href="/tags/%E7%AE%A1%E7%90%86%E7%8A%B6%E6%80%81/" 
        title="管理状态">
        <div class="tags-list-item">管理状态</div>
      </a>
    
      <a 
        href="/tags/%E9%81%BF%E5%85%8D%E6%B5%AA%E8%B4%B9/" 
        title="避免浪费">
        <div class="tags-list-item">避免浪费</div>
      </a>
    
      <a 
        href="/tags/%E7%AE%80%E5%8D%95%E5%8C%96/" 
        title="简单化">
        <div class="tags-list-item">简单化</div>
      </a>
    
      <a 
        href="/tags/%E4%BA%A4%E7%BB%99%E5%AD%90%E7%B1%BB/" 
        title="交给子类">
        <div class="tags-list-item">交给子类</div>
      </a>
    
      <a 
        href="/tags/%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" 
        title="访问数据结构">
        <div class="tags-list-item">访问数据结构</div>
      </a>
    
      <a 
        href="/tags/%E9%80%82%E5%BA%94%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" 
        title="适应设计模式">
        <div class="tags-list-item">适应设计模式</div>
      </a>
    
      <a 
        href="/tags/%E5%88%86%E5%BC%80%E8%80%83%E8%99%91/" 
        title="分开考虑">
        <div class="tags-list-item">分开考虑</div>
      </a>
    
      <a 
        href="/tags/%E7%94%A8%E7%B1%BB%E6%9D%A5%E8%A1%A8%E7%A4%BA/" 
        title="用类来表示">
        <div class="tags-list-item">用类来表示</div>
      </a>
    
      <a 
        href="/tags/%E4%B8%80%E8%87%B4%E6%80%A7/" 
        title="一致性">
        <div class="tags-list-item">一致性</div>
      </a>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
            <main class="main-column">
              
<article class="card card-content">
  <header>
    <h1 class="post-title">
      解释器模式
    </h1>
  </header>
  <div class="post-meta post-show-meta">
    <time datetime="2023-03-20T01:16:27.266Z">
      <i 
        class="iconfont icon-calendar" 
        style="margin-right: 2px;">
      </i>
      <span>2023-03-20</span>
    </time>
    
      <span class="dot"></span>
      
        <a 
          href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" 
          class="post-meta-link">
          设计模式
        </a>
      
    
    
      <span class="dot"></span>
      <span>5.1k 字</span>
    
  </div>
  
    <div 
      class="post-meta post-show-meta" 
      style="margin-top: -10px;">
      <div style="display: flex; align-items: center;">
        <i 
          class="iconfont icon-biaoqian" 
          style="margin-right: 2px; font-size: 1.15rem;">
        </i>
        
          
          <a 
            href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" 
            class="post-meta-link">
            设计模式
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/%E7%94%A8%E7%B1%BB%E6%9D%A5%E8%A1%A8%E7%A4%BA/" 
            class="post-meta-link">
            用类来表示
          </a>
        
      </div>
    </div>
  
  </header>
  <div 
    id="section" 
    class="post-content">
    <h1 id="Interpreter模式（解释器模式）"><a href="#Interpreter模式（解释器模式）" class="headerlink" title="Interpreter模式（解释器模式）"></a>Interpreter模式（解释器模式）</h1><blockquote>
<p>设计模式的目的之一就是提高类的可服用行。可复用性是指不哟过做太大修改（甚至是不做任何修改）就可以在多种场景使用之前编写的类。</p>
<p>在Interpreter模式中，程序要解决的问题会被用非常简单的“迷你语言”表述出来，即用”迷你语言“编写的”迷你程序“把具体的问题表述出来。迷你程序是无法单独工作的，我们还需要用Java语言编写一个负责”翻译“（interpreter）的程序。翻译程序会理解迷你语言，并解释和运行迷你程序。这单翻译程序也被称为解释器。这样，当需要解决的问题发生变化时，不需要修改Java语言程序，只需要修改迷你语言程序即可应对。</p>
<p>下面，用图示展示一下当问题发生变化时，需要那个级别的代码。使用java语言编程时，需要修改的代码如图所示。虽然我们希望需要修改的代码尽量少，但是多多少少都必须修改Java代码。</p>
<img src="/2023/03/20/InterpreterPattern/image-20230320095430039.png" alt="image-20230320095430039" style="zoom:50%;" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/03/20/InterpreterPattern/image-20230320095430039.png" class="lozad post-image">

<p>但是，在使用Interpreter模式后，我们就无需修改Java程序，只需修改迷你语言编写的迷你程序即可。</p>
<img src="/2023/03/20/InterpreterPattern/image-20230320095840189.png" alt="image-20230320095840189" style="zoom:50%;" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/03/20/InterpreterPattern/image-20230320095840189.png" class="lozad post-image">
</blockquote>
<h2 id="迷你语言"><a href="#迷你语言" class="headerlink" title="迷你语言"></a>迷你语言</h2><h3 id="迷你语言的命令"><a href="#迷你语言的命令" class="headerlink" title="迷你语言的命令"></a>迷你语言的命令</h3><blockquote>
<p>在开始学习Interpreter模式的示例程序之前，先了解一下涉及的“迷你语言”。迷你语言的用途是控制无线玩具车。虽然说是控制无线玩具车，其实能做的事情不过一下3种。</p>
<ul>
<li><p>前进1米（go）</p>
</li>
<li><p>右转（right）</p>
</li>
<li><p>左转（left）</p>
<blockquote>
<p>以上就是可以向玩具车发送的命令。go是前进1米后停止的命令；right是原地向右转的命令；left是原地向左转的命令。在实际操作时，是不能完全没有偏差地原地转弯的。为了使问题简单化，我们这里并不会改变玩具车的位置，而是像将其放在旋转桌子上一样，让它转个向。</p>
<p>如果只是这样，可能觉得没什么意思。所以，接下来我们再加一个循环命令。</p>
</blockquote>
</li>
<li><p>重复（repeat）</p>
</li>
</ul>
<p>以上命令组合起来就是可以控制无线玩具车的迷你语言了。</p>
</blockquote>
<h3 id="迷你语言程序示例"><a href="#迷你语言程序示例" class="headerlink" title="迷你语言程序示例"></a>迷你语言程序示例</h3><blockquote>
<p>下面来看一段用迷你语言编写的迷你程序。下面这条语句可以控制无线玩具车前进（之后停止）。</p>
<pre class="line-numbers language-none"><code class="language-none">program go end<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>为了便于大家看出语句的开头和结尾，在语句前后分别加上了program和end关键字（稍后会学习迷你语言的语法）。</p>
<p>接下来是一段让无线玩具车先前进一米，接着让它右旋转两次再返回来的程序。</p>
<pre class="line-numbers language-none"><code class="language-none">program go right right go end<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>再接下来这段程序是让无线玩具车按照正方形路径行进。</p>
<pre class="line-numbers language-none"><code class="language-none">program go right go right go right go right end ......（A）<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>（A）程序的最后（即end之前）之所以加上了一个right，是因为当无线玩具车返回到起点后，我们希望它的方向与出发时相同。在（A）程序中，重复出现了4次go right。这样我们可以使用repeat…end语句来实现下面的（B）程序（为了能够编写出这段程序，我们需要定义迷你语言的语法）。</p>
<pre class="line-numbers language-none"><code class="language-none">program repeat 4 go right end end	   ......（B）<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在（B）程序的最后出现了两个end，其中第一个（左边）end表示repeat的结束，第二个（右边）表示program的结束。也就是说，程序如下。</p>
<pre class="line-numbers language-none"><code class="language-none">program    程序开始
    repeat    循环开始
        4         循环次数
        go        前进
        right     右转
    end       循环结束
end        程序结束<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在脑海中，车轮是不是已经骨碌骨碌转起来了呢？那么，我们再一起看看下面这段程序是如何操控无线玩具车的，</p>
<pre class="line-numbers language-none"><code class="language-none">program repeat 4 repeat 3 go right left end right end end<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>现在玩具车会按照锯齿形状的路线进行前进。这里有两个repeat，可能会有些难以理解，不过按照下面这样分解一下就很容易理解了。</p>
<pre class="line-numbers language-none"><code class="language-none">program        程序开始
    repeat          循环开始（外侧）
        4               循环的次数
        repeat          循环开始（内侧）
            3               循环的次数
            go              前进
            right           右转
            left            左转
        end             循环结束（内侧）
        right           右转
    end             循环结束（外侧）
end            程序结束<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h2 id="迷你语言的语法"><a href="#迷你语言的语法" class="headerlink" title="迷你语言的语法"></a>迷你语言的语法</h2><blockquote>
<p>下面展示了迷你语言的语法。这里使用的描述方法是BNF的一个变种。BNF是Backus- Naur Form或Backus Normal Form 的略称，它经常被用于描述语法。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;program&gt; ::&#x3D; program &lt;command list&gt;
&lt;command list&gt; ::&#x3D; &lt;command&gt;* end
&lt;command&gt; ::&#x3D; &lt;repeat command&gt; | &lt;primitive command&gt;
&lt;repeat command&gt; ::&#x3D; repeat &lt;number&gt; &lt;command list&gt;
&lt;primitive command&gt; ::&#x3D; go | right | left<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们按照上面的顺序学习。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;program&gt; ::&#x3D; program &lt;command list&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>首先，我们定义了程序<code>&lt;program&gt;</code>,即“所谓<code>&lt;program&gt;</code>，是指program关键字后面跟着的命令列表<code>&lt;command list&gt;</code>“,”::&#x3D;”的左边表示定义的名字，右边表示定义的内容。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;command list&gt; ::&#x3D; &lt;command&gt;* end<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>接着，我们定义了命令列表<code>&lt;command list&gt;</code>，即“所谓<code>&lt;command list&gt;</code>，是指重复0次以上<code>&lt;command&gt;</code>后，接着一个end关键字”。“*”表示前面的内容循环0次以上。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;command&gt; ::&#x3D; &lt;repeat command&gt; | &lt;primitive command&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>现在，我们来定义<code>&lt;command&gt;</code>，即“所谓<code>&lt;command&gt;</code>，是指<code>&lt;repeat command&gt;</code>或者<code>&lt;primitive command&gt;</code>“。该定义中“｜”表示“或”的意思。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;repeat command&gt; ::&#x3D; repeat &lt;number&gt; &lt;command list&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>接下来，我们定义循环命令，即“所谓<code>&lt;repeat command&gt;</code>，是指repeat关键字后面跟着循环次数<code>&lt;number&gt;</code>和要循环的命令列表<code>&lt;command list&gt;</code>。其中的命令列表<code>&lt;command list&gt;</code>之前已经定义过了，而在定义命令列表<code>&lt;command list&gt;</code>的时候使用了<code>&lt;command&gt;</code>，在定义<code>&lt;command&gt;</code>的时候又使用了<code>&lt;repeat command&gt;</code>，而在定义<code>&lt;repeat command&gt;</code>的时候又使用了<code>&lt;command list&gt;</code>。像这样，在定义某个东西是，它自身又出现在了定义的内容中，我们称这种定义为递归定义。稍后，我们会使用Java语言实现迷你语言的解释器，到时候会有相应的代码结构来解释递归定义，因此，先在脑海中记住这个概念。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;primitive command&gt; ::&#x3D; go | right | left<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这是基本命令<code>&lt;primitive command&gt;</code>的定义，即“所谓<code>&lt;primitive command&gt;</code>，是指go或者right或者left”。</p>
<p>最后只剩下<code>&lt;number&gt;</code>了，想要定义出全部的<code>&lt;number&gt;</code>可能非常复杂，这里省略了它的定义。总之，请把<code>&lt;number&gt;</code>看作是3、4和12345这样的自然数即可。</p>
</blockquote>
<h3 id="终结符表达式与非终结符表达式"><a href="#终结符表达式与非终结符表达式" class="headerlink" title="终结符表达式与非终结符表达式"></a>终结符表达式与非终结符表达式</h3><blockquote>
<p>先来稍微了解一下语法术语。</p>
<p>前面讲到的像<code>&lt;primitive command&gt;</code>这样的不会被进一步展开的表达式称为“终结符表达式”（Terminal Expression）。我们知道，巴士和列车的终到站被称为终点站，这里的终结符就类似于终点站，它表示语法规则的重点。</p>
<p>与之相对的是，像<code>&lt;program&gt;</code>和<code>&lt;command&gt;</code>这样的需要被进一步展开的表达式被称为“非终结表达式”。</p>
</blockquote>
<h2 id="示例类图"><a href="#示例类图" class="headerlink" title="示例类图"></a>示例类图</h2><blockquote>
<p><img src="/2023/03/20/InterpreterPattern/image-20230320152107851.png" alt="image-20230320152107851" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/03/20/InterpreterPattern/image-20230320152107851.png" class="lozad post-image"></p>
</blockquote>
<h2 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h2><blockquote>
<p>迷你语言的学习至此就结束了，下面来看看示例程序。指段示例程序实现了一个迷你程序的<strong>语法解析</strong>器。</p>
<p>在之前学习迷你程序的相关内容时，分别学习了迷你程序的各个语法部分。像这样将迷你程序党组普通字符分解，然后看看各个部分分别时什么结构的过程，就是语法解析。</p>
<p>例如有以下迷你程序。</p>
<pre class="line-numbers language-none"><code class="language-none">program repeat 4 go righr end end<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这段迷你程序推导成为下面那样的结构（语法树）的处理，就是语法解析。</p>
<img src="/2023/03/20/InterpreterPattern/image-20230321133602453.png" alt="image-20230321133602453" style="zoom:50%;" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/03/20/InterpreterPattern/image-20230321133602453.png" class="lozad post-image">
</blockquote>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Node</td>
<td>表示语法树“节点”的类</td>
</tr>
<tr>
<td>ProgramNode</td>
<td>对应<code>&lt;program&gt;</code>类</td>
</tr>
<tr>
<td>CommandListNode</td>
<td>对应<code>&lt;command list&gt;</code>的类</td>
</tr>
<tr>
<td>CommandNode</td>
<td>对应<code>&lt;command&gt;</code>的类</td>
</tr>
<tr>
<td>RepeatCommandNode</td>
<td>对应<code>&lt;repeat command&gt;</code>的类</td>
</tr>
<tr>
<td>PrimitiveCommandNode</td>
<td>对应<code>&lt;primitive command&gt;</code>的类</td>
</tr>
<tr>
<td>Context</td>
<td>表示语法解析上下文</td>
</tr>
<tr>
<td>ParseException</td>
<td>表示语法解析中可能会发生的异常的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序行为的类</td>
</tr>
</tbody></table>
<h3 id="Node类"><a href="#Node类" class="headerlink" title="Node类"></a>Node类</h3><blockquote>
<p>Node类是语法树中各个部分（节点）中的最顶层的类。在Node类中只声明了一个parse抽象方法，该方法用于”进行语法解析处理”。但Node类仅仅是声明该方法，具体怎么解析交由Node类的子类负责。parse方法接收到的参数Context是表示语法解析上下文的类，稍后将来学习parse方法。在parse的声明中，我们使用了throws关键字。它表示在语法解析中如果发生了错误，parse方法就会抛出ParseException异常。</p>
<p>如果只看Node类，我们还无法知道具体怎么进行语法解析，所以接着往下看。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="ProgramNode类"><a href="#ProgramNode类" class="headerlink" title="ProgramNode类"></a>ProgramNode类</h3><blockquote>
<p>首先，我们看看表示程序<code>&lt;program&gt;</code>ProgramNode类。在ProgramNode类中定义了一个Node类型的CommandListNode字段，该字段用于保存<code>&lt;command list&gt;</code>对应的结构（节点）。</p>
<p>那么，ProgramNode的parse方法究竟进行了什么处理呢？通过查看迷你语言的BNF描述我们可以发现，<code>&lt;program&gt;</code>的定义中最开始会出现program这个单词。因此，我们用下面的语句跳过这个单词。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">context<span class="token punctuation">.</span><span class="token function">skipToken</span><span class="token punctuation">(</span><span class="token string">"program"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们称语法解析时的处理单位为<strong>标记</strong>（token），在迷你语言中，“标记”相当于“英文单词”。在一般的编程语言中，“+” 和 “&#x3D;&#x3D;” 等也是标记。更具体地说，语法分析（lex）时从文字中得到的标记，而语法解析（parse）则是根据标记推导出语法树。</p>
<p>上面skipToken方法可以跳过program这个标记。如果没有这个标记就会抛出ParseException异常。</p>
<p>继续查看BNF描述会发现，在program后面会跟着<code>&lt;command list&gt;</code>。这里，我们会生成<code>&lt;command list&gt;</code>对应CommandListNode类的实例，然后调用实例的parse方法。请注意，ProgramNode类的方法并不知道<code>&lt;command list&gt;</code>的内容。即在ProgramNode类中实现的内容，并没有超出下面的BNF所描述的范围。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;program&gt; ::&#x3D; program &lt;command list&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>toString方法用于生成表示该节点的字符串。在Java中，连接实例与字符串时会自动调用实例的toString方法，因此如下（1）与（2）是等价的。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token string">"[program "</span> <span class="token operator">+</span> commandListNode <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>              <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token string">"[program "</span> <span class="token operator">+</span> commandListNode<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>请注意，toString方法的实现也与上面的BNF描述完全相符。</p>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProgramNode</span> <span class="token keyword">extends</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span> commandListNode<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">&#123;</span>
        context<span class="token punctuation">.</span><span class="token function">skipToken</span><span class="token punctuation">(</span><span class="token string">"program"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commandListNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandListNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commandListNode<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> toString <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"[program "</span> <span class="token operator">+</span> commandListNode <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="CommandListNode类"><a href="#CommandListNode类" class="headerlink" title="CommandListNode类"></a>CommandListNode类</h3><blockquote>
<p>下面来看看CommandListNode类。<code>&lt;command list&gt;</code>的BNF描述如下。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;command list&gt; ::&#x3D; &lt;command&gt;* end<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>即重复0次以上<code>&lt;command&gt;</code>，然后以end结束。为了能保存0次以上的<code>&lt;command&gt;</code>，我们定义了java.util.ArrayList类型的字段list，在该字段中保存与<code>&lt;command&gt;</code>对应的CommandNode类的实例。</p>
<p>CommandListNode类的parse方法是怎么实现的呢？首先，如果当前的标记context.currentToken()是null，表示后面没有任何标记（也就是已经解析至迷你程序的末尾）了。这时，pares方法会先设置ParseExecption异常中的消息为“缺少end（Missing ‘end’）”，然后抛出ParseException异常。</p>
<p>接下来，如果当前的标记是end，表示已经解析至<code>&lt;command1ist&gt;</code>的末尾。这时，parse方法会跳过end，然后break出while循环。</p>
<p>再接下来，如果当前的标记不是end，则表示当前标记是<code>&lt;command&gt;</code>。这时，parse方法会生成与<code>&lt;command&gt;</code>对应的comandNode的实例，并调用它的parse方法进行解析。然后，还会将comandNode的实例add至list字段中。</p>
<p>应该看出来了，这里的实现也没有超出BNF描述的范围。我们在编程时要尽量忠实于BNF描述，原封不动地将BNF描述转换为Java程序。这样做可以降低出现Bug的可能性。在编程过程中，往往很容易受到“如果这样改一下可以提高程序效率吧”这样的诱惑，会不自觉地想在类中加人读取更深层次的节点的处理，但这样反而可能会引人意想不到的Bug。Interpreter模式本来就采用了迷你语言这样的间接处理，所以耍一些小聪明来试图提高效率并不明智。</p>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommandListNode</span> <span class="token keyword">extends</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">ArrayList</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">currentToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ParseException</span><span class="token punctuation">(</span><span class="token string">"Missing 'end'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">currentToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                context<span class="token punctuation">.</span><span class="token function">skipToken</span><span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Node</span> commandNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                commandNode<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>commandNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="CommandNode类"><a href="#CommandNode类" class="headerlink" title="CommandNode类"></a>CommandNode类</h3><blockquote>
<p>如果理解了前面的ProgramNode类和CommandListNode类，那么应该也可以很快地理解CommandNode类。<code>&lt;command&gt;</code>的BNF描述如下。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token generics"><span class="token punctuation">&lt;</span>command<span class="token punctuation">></span></span> <span class="token operator">::</span><span class="token operator">=</span> <span class="token generics"><span class="token punctuation">&lt;</span>repeat command<span class="token punctuation">></span></span> <span class="token operator">|</span> <span class="token generics"><span class="token punctuation">&lt;</span>primitive command<span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在代码中的Node类型的node字段中保存的是与<code>&lt;repeat command&gt;</code>对应的RepeatCommandNode类的实例，或与<code>&lt;primitive command&gt;</code>对应的PrimitiveCommandNode类的实例。</p>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommandNode</span> <span class="token keyword">extends</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span> node<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">currentToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"repeat"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RepeatCommandNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            node<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrimitiveCommandNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            node<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> node<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="RepeatCommandNode类"><a href="#RepeatCommandNode类" class="headerlink" title="RepeatCommandNode类"></a>RepeatCommandNode类</h3><blockquote>
<p>RepeatCommand类对应<code>&lt;repeat command&gt;</code>的类。<code>&lt;repeat command&gt;</code>的BNF描述如下。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token generics"><span class="token punctuation">&lt;</span>repeat command<span class="token punctuation">></span></span> <span class="token operator">::</span><span class="token operator">=</span> repeat <span class="token generics"><span class="token punctuation">&lt;</span>number<span class="token punctuation">></span></span><span class="token generics"><span class="token punctuation">&lt;</span>command list<span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在代码中，<code>&lt;nummber&gt;</code>被保存在int型字段number中，<code>&lt;command list&gt;</code>被保存在Node型字段commandListNode中。</p>
<p>现在，大家应该都注意到parse方法的递归关系了。让我们追溯一下parse方法的调用关系。</p>
<ul>
<li>在RepeactCommandNode类parse方法中，会生成CommandListNode的实例，然后调用它的parse方法</li>
<li>在CommandListNode类parse方法中，会生成CommandNode的实例，然后调用它的parse方法</li>
<li>在CommandNode类的parse方法中，会生成RepeatCommandNode的实例，然后调用它的parse方法</li>
<li>在RepeatCommandNode类的parse方法中······</li>
</ul>
<p>这样的parse方法调用到底要持续到什么时候呢？其实，它的终点就是终结符表达式。在ConmandNode类的parse方法中，程序并不会一直进人if语句的RepeatcomandNode处理分支中，最终总是会进人PrimitiveComumandNode的处理分支。并且，不会从PrimitiveCommandNode的parse方法中再调用其他类的parse方法。</p>
<p>如果不习惯递归定义的处理方式，可能会感觉到这里似乎进人了死循环。其实这是错觉。不论是在BNF描述中还是在Java程序中，一定都会结束于终结符表达式。如果没有结束于终结符表达式，那么一定是语法描述有问题。</p>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RepeatCommandNode</span> <span class="token keyword">extends</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> number<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span> commandListNode<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">&#123;</span>
        context<span class="token punctuation">.</span><span class="token function">skipToken</span><span class="token punctuation">(</span><span class="token string">"repeat"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        number <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">currentNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">nextToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commandListNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandListNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commandListNode<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"[repeat "</span> <span class="token operator">+</span> number <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> commandListNode <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="PrimitiveCommandNode类"><a href="#PrimitiveCommandNode类" class="headerlink" title="PrimitiveCommandNode类"></a>PrimitiveCommandNode类</h3><blockquote>
<p>PrimitiveCommandNode类对应的BNF描述如下。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;primitive command&gt; ::&#x3D; go | right | left<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>确实，PrimitiveCommandNode类的parse方法没有调用其他类的parse方法。</p>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrimitiveCommandNode</span> <span class="token keyword">extends</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">&#123;</span>
        name <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">currentToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">skipToken</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"go"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ParseException</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">" is undefined"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Context类"><a href="#Context类" class="headerlink" title="Context类"></a>Context类</h3><blockquote>
<p>至此，关于Node类以及它的子类的学习就全部结束了。剩下的就是Context类了。Context类提供了语法解析所必须的方法。</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>NextToken</td>
<td>获取下一个标记（前进至下一个标记）</td>
</tr>
<tr>
<td>currentToken</td>
<td>获取当前的标记（不回前进至下一个标记）</td>
</tr>
<tr>
<td>skipToken</td>
<td>先检查当前标记，然后获取下一个标记（前进至下一个标记）</td>
</tr>
<tr>
<td>currentNumber</td>
<td>获取当前标记对应的数值（不会前进至下一个标记）</td>
</tr>
</tbody></table>
<p>这里，我们使用java.util.StringTokenIzer类来简化我们的程序，它会将接收到的字符串分隔为标记。在分隔字符串时使用的分隔符是空格“‘ ’”、制表符“‘\t’”、换行符“‘\n’”、回车符“‘\r’”、换页符”‘\f’”（也可以使用其他分隔符，请根据需要查阅Java的API文档）。</p>
<p>Context类使用的java.util.StringTokenizer的方法</p>
<p>3</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>NextToken</td>
<td>获取下一个标记（前进至下一个标记）</td>
</tr>
<tr>
<td>hasMoreToken</td>
<td>检查是否还有下一个标记</td>
</tr>
</tbody></table>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">	<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">StringTokenizer</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Context</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">StringTokenizer</span> tokenizer<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> currentToken<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        tokenizer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringTokenizer</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">nextToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">nextToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tokenizer<span class="token punctuation">.</span><span class="token function">hasMoreTokens</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            currentToken <span class="token operator">=</span> tokenizer<span class="token punctuation">.</span><span class="token function">nextToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            currentToken <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> currentToken<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">currentToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> currentToken<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">skipToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>currentToken<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ParseException</span><span class="token punctuation">(</span><span class="token string">"Warning: "</span> <span class="token operator">+</span> token <span class="token operator">+</span> <span class="token string">" is expected, but "</span> <span class="token operator">+</span> currentToken <span class="token operator">+</span> <span class="token string">"is found."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token function">nextToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">currentNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            number <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>currentToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NumberFormatException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ParseException</span><span class="token punctuation">(</span><span class="token string">"Warning: "</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> number<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ParseException类"><a href="#ParseException类" class="headerlink" title="ParseException类"></a>ParseException类</h3><blockquote>
<p>ParseException类是表示语法解析时可能发生的异常的类。该类比较简单，没有什么需要特别注意的地方。</p>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ParseException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token class-name">ParseException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h3><blockquote>
<p>Main类是启动我们之前学习的迷你解释器的程序。它会读取program.txt文件，然后逐行解析迷你程序，并将解析结果显示出来。</p>
<p>在显示结果中，以“text &#x3D;” 开头的部分是迷你程序语句，以“node &#x3D; ”开头的部分是语法解析结果。通过查看运行运行结果我们可以发现，语法解释器识别出了program … end字符串中的迷你语言的语法元素，并为它们加上了[]。这表示语法解释器正确的理解了我们定义的迷你语言。</p>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">BufferedReader</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileReader</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">BufferedReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">"program.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> text<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>text <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"text = \""</span> <span class="token operator">+</span> text <span class="token operator">+</span><span class="token string">"\""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Node</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProgramNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                node<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Context</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"node = "</span> <span class="token operator">+</span> node<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="program-txt"><a href="#program-txt" class="headerlink" title="program.txt"></a>program.txt</h3><pre class="line-numbers language-none"><code class="language-none">program end
program go end
program go right go right go right go right end
program repeat 4 go right end end
program repeat 4 repeat 3 go right go left end right end end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Interpreter模式中的登场角色"><a href="#Interpreter模式中的登场角色" class="headerlink" title="Interpreter模式中的登场角色"></a>Interpreter模式中的登场角色</h2><ul>
<li><h3 id="AbstractExpression（抽象表达式）"><a href="#AbstractExpression（抽象表达式）" class="headerlink" title="AbstractExpression（抽象表达式）"></a>AbstractExpression（抽象表达式）</h3><blockquote>
<p>AbstractExpression角色定义了语法树的共同接口（API）。在示例程序中，由Node类扮演此角色。</p>
<p>在示例程序中，共同接口（API）的名字是parse，不过在下面图中它的名字是interpreter。</p>
</blockquote>
</li>
<li><h3 id="TerminalExpression（终结符表达式）"><a href="#TerminalExpression（终结符表达式）" class="headerlink" title="TerminalExpression（终结符表达式）"></a>TerminalExpression（终结符表达式）</h3><blockquote>
<p>TerminalExpression角色对应BNF中的终结符表达式。</p>
<p>在示例程序中，由PrimitiveCommandNode类扮演此角色。</p>
</blockquote>
</li>
<li><h3 id="NonterminalExpression（非终结表达式）"><a href="#NonterminalExpression（非终结表达式）" class="headerlink" title="NonterminalExpression（非终结表达式）"></a>NonterminalExpression（非终结表达式）</h3><blockquote>
<p>Context角色为解释器进行语法解析提供了必要的信息。</p>
<p>在示例程序中，由Context类扮演此角色。</p>
</blockquote>
</li>
<li><h3 id="Context（文脉、上下文）"><a href="#Context（文脉、上下文）" class="headerlink" title="Context（文脉、上下文）"></a>Context（文脉、上下文）</h3><blockquote>
<p>Context角色为解释器进行语法解析提供了必要的信息。</p>
<p>在示例程序中，由Context类扮演此角色。</p>
</blockquote>
</li>
<li><h3 id="Client（请求者）"><a href="#Client（请求者）" class="headerlink" title="Client（请求者）"></a>Client（请求者）</h3><blockquote>
<p>为了推到语法树，Client角色会调用TerminalExpression角色和NonterminalExpression角色。</p>
<p>在示例程序中，由Main类扮演此角色。</p>
</blockquote>
</li>
</ul>
<h3 id="InterPreter模式的类图"><a href="#InterPreter模式的类图" class="headerlink" title="InterPreter模式的类图"></a>InterPreter模式的类图</h3><blockquote>
<p><img src="/2023/03/20/InterpreterPattern/image-20230320171552092.png" alt="image-20230320171552092" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2023/03/20/InterpreterPattern/image-20230320171552092.png" class="lozad post-image"></p>
</blockquote>
<h2 id="拓展思路要点"><a href="#拓展思路要点" class="headerlink" title="拓展思路要点"></a>拓展思路要点</h2><h3 id="还有其他哪些迷你语言"><a href="#还有其他哪些迷你语言" class="headerlink" title="还有其他哪些迷你语言"></a>还有其他哪些迷你语言</h3><blockquote>
<ul>
<li><p><strong>正则表达式</strong></p>
<blockquote>
<p>raining &amp; (dogs | cats) *</p>
<p>这个表达式的意思是“在raining后重复出现0次以上dogs或cats”</p>
</blockquote>
</li>
<li><p><strong>检索表达式</strong></p>
<blockquote>
<p>garkic and not onions</p>
<p>这个表达式的意思是“包含garlic但不包含onions”</p>
</blockquote>
</li>
<li><p><strong>批处理表达式</strong></p>
<blockquote>
<p>Interpreter模式还可以处理批处理语言，即将基本命令组合在一起，并按顺序执行或是循环执行的语言。</p>
<p>无线遥控车操控就是一种批处理语言。</p>
</blockquote>
</li>
</ul>
</blockquote>
<h3 id="跳过标记还是读取标记"><a href="#跳过标记还是读取标记" class="headerlink" title="跳过标记还是读取标记"></a>跳过标记还是读取标记</h3><blockquote>
<p>在制作解释器时，经常会出现多读了一个标记或是漏读了一个标记的Bug。在编写各个中姐夫表达式应对的方法时，我们经常时刻注意“进入这个方法时已经读至那个标记了？出了这个方法时应该读至那个标记？”</p>
</blockquote>

  </div>
  <div>
    
      <div 
        class="post-note note-warning copyright" 
        style="margin-top: 42px">
        <p>
          <span style="font-weight: bold;">作者：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="/about">
            简单且极端
          </a>
        </p>
        <p>
          <span style="font-weight: bold;">文章链接：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="https://extremelys.github.io/2023/03/20/InterpreterPattern/">
            https://extremelys.github.io/2023/03/20/InterpreterPattern/
          </a>
        </p>
        <p><span style="font-weight: bold;">版权声明：</span>本博客所有文章除特别声明外，均采用<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0 协议</a>。转载请注明出处！</p>
      </div>
    
  </div>
</article>
<div class="nav">
  
  
    <div class="nav-item-next">
      <a 
        href="/2023/03/16/CommandPattern/" 
        class="nav-link">
        <div>
          <div class="nav-label">下一篇</div>
          
            <div class="nav-title">命令模式 </div>
          
        </div>
        <i class="iconfont icon-right nav-next-icon"></i>
      </a>
    </div>
  
</div>

<div 
  class="card card-content toc-card" 
  id="mobiletoc">
  <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Interpreter%E6%A8%A1%E5%BC%8F%EF%BC%88%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">Interpreter模式（解释器模式）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80"><span class="toc-text">迷你语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-text">迷你语言的命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E7%A4%BA%E4%BE%8B"><span class="toc-text">迷你语言程序示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-text">迷你语言的语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E9%9D%9E%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">终结符表达式与非终结符表达式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E7%B1%BB%E5%9B%BE"><span class="toc-text">示例类图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E7%A8%8B%E5%BA%8F"><span class="toc-text">示例程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Node%E7%B1%BB"><span class="toc-text">Node类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProgramNode%E7%B1%BB"><span class="toc-text">ProgramNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CommandListNode%E7%B1%BB"><span class="toc-text">CommandListNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CommandNode%E7%B1%BB"><span class="toc-text">CommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RepeatCommandNode%E7%B1%BB"><span class="toc-text">RepeatCommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PrimitiveCommandNode%E7%B1%BB"><span class="toc-text">PrimitiveCommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Context%E7%B1%BB"><span class="toc-text">Context类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ParseException%E7%B1%BB"><span class="toc-text">ParseException类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Main%E7%B1%BB"><span class="toc-text">Main类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#program-txt"><span class="toc-text">program.txt</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interpreter%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E7%99%BB%E5%9C%BA%E8%A7%92%E8%89%B2"><span class="toc-text">Interpreter模式中的登场角色</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AbstractExpression%EF%BC%88%E6%8A%BD%E8%B1%A1%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">AbstractExpression（抽象表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TerminalExpression%EF%BC%88%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">TerminalExpression（终结符表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NonterminalExpression%EF%BC%88%E9%9D%9E%E7%BB%88%E7%BB%93%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">NonterminalExpression（非终结表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Context%EF%BC%88%E6%96%87%E8%84%89%E3%80%81%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%89"><span class="toc-text">Context（文脉、上下文）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Client%EF%BC%88%E8%AF%B7%E6%B1%82%E8%80%85%EF%BC%89"><span class="toc-text">Client（请求者）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InterPreter%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%B1%BB%E5%9B%BE"><span class="toc-text">InterPreter模式的类图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%93%E5%B1%95%E6%80%9D%E8%B7%AF%E8%A6%81%E7%82%B9"><span class="toc-text">拓展思路要点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%98%E6%9C%89%E5%85%B6%E4%BB%96%E5%93%AA%E4%BA%9B%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80"><span class="toc-text">还有其他哪些迷你语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BF%87%E6%A0%87%E8%AE%B0%E8%BF%98%E6%98%AF%E8%AF%BB%E5%8F%96%E6%A0%87%E8%AE%B0"><span class="toc-text">跳过标记还是读取标记</span></a></li></ol></li></ol></li></ol>
</div>
            </main>
            <aside class="right-column">
              <div class="sticky-widescreen">
  
  
    <article class="card card-content toc-card">
      <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Interpreter%E6%A8%A1%E5%BC%8F%EF%BC%88%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">Interpreter模式（解释器模式）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80"><span class="toc-text">迷你语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-text">迷你语言的命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E7%A4%BA%E4%BE%8B"><span class="toc-text">迷你语言程序示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-text">迷你语言的语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E9%9D%9E%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">终结符表达式与非终结符表达式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E7%B1%BB%E5%9B%BE"><span class="toc-text">示例类图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E7%A8%8B%E5%BA%8F"><span class="toc-text">示例程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Node%E7%B1%BB"><span class="toc-text">Node类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProgramNode%E7%B1%BB"><span class="toc-text">ProgramNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CommandListNode%E7%B1%BB"><span class="toc-text">CommandListNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CommandNode%E7%B1%BB"><span class="toc-text">CommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RepeatCommandNode%E7%B1%BB"><span class="toc-text">RepeatCommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PrimitiveCommandNode%E7%B1%BB"><span class="toc-text">PrimitiveCommandNode类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Context%E7%B1%BB"><span class="toc-text">Context类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ParseException%E7%B1%BB"><span class="toc-text">ParseException类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Main%E7%B1%BB"><span class="toc-text">Main类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#program-txt"><span class="toc-text">program.txt</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interpreter%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E7%99%BB%E5%9C%BA%E8%A7%92%E8%89%B2"><span class="toc-text">Interpreter模式中的登场角色</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AbstractExpression%EF%BC%88%E6%8A%BD%E8%B1%A1%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">AbstractExpression（抽象表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TerminalExpression%EF%BC%88%E7%BB%88%E7%BB%93%E7%AC%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">TerminalExpression（终结符表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NonterminalExpression%EF%BC%88%E9%9D%9E%E7%BB%88%E7%BB%93%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89"><span class="toc-text">NonterminalExpression（非终结表达式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Context%EF%BC%88%E6%96%87%E8%84%89%E3%80%81%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%89"><span class="toc-text">Context（文脉、上下文）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Client%EF%BC%88%E8%AF%B7%E6%B1%82%E8%80%85%EF%BC%89"><span class="toc-text">Client（请求者）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InterPreter%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%B1%BB%E5%9B%BE"><span class="toc-text">InterPreter模式的类图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%93%E5%B1%95%E6%80%9D%E8%B7%AF%E8%A6%81%E7%82%B9"><span class="toc-text">拓展思路要点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%98%E6%9C%89%E5%85%B6%E4%BB%96%E5%93%AA%E4%BA%9B%E8%BF%B7%E4%BD%A0%E8%AF%AD%E8%A8%80"><span class="toc-text">还有其他哪些迷你语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BF%87%E6%A0%87%E8%AE%B0%E8%BF%98%E6%98%AF%E8%AF%BB%E5%8F%96%E6%A0%87%E8%AE%B0"><span class="toc-text">跳过标记还是读取标记</span></a></li></ol></li></ol></li></ol>
    </article>
  
  
  <article class="card card-content">
    <div class="recent-posts-card">
  <div class="recent-posts-header">
    <i 
      class="iconfont icon-wenzhang_huaban" 
      style="padding-right: 2px;">
    </i>最近文章
  </div>
  <div class="recent-posts-list">
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-03-20</div>
        <a href="/2023/03/20/InterpreterPattern/"><div class="recent-posts-item-content">解释器模式</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-03-16</div>
        <a href="/2023/03/16/CommandPattern/"><div class="recent-posts-item-content">命令模式</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-03-16</div>
        <a href="/2023/03/16/ProxyPatten/"><div class="recent-posts-item-content">代理模式</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-03-15</div>
        <a href="/2023/03/15/FlyweightPattrn/"><div class="recent-posts-item-content">享元模式</div></a>
      </div>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
          </div>
        </div>
      </div>
    </div>
     
    <footer class="footer">
  <div class="footer-container">
    <div>
      <div class="footer-dsc">
        <span>
          Copyright ©
          
            2022
          
          
                - 
                2023
          
        </span>
        &nbsp;
        <a 
          href="/" 
          class="footer-link">
          简单且极端
        </a>
      </div>
    </div>

    
      <div class="footer-dsc">
        
          Powered by
          <a 
            href="https://hexo.io/" 
            class="footer-link" 
            target="_blank" 
            rel="nofollow noopener noreferrer">
            &nbsp;Hexo
          </a>
        
        
          <span>&nbsp;|&nbsp;</span>
        
        
          Theme -
          <a 
            href="https://github.com/theme-kaze" 
            class="footer-link" 
            target="_blank"
            rel="nofollow noopener noreferrer">
            &nbsp;Kaze
          </a>
        
      </div>
    
    
    
    
</footer>
 
    
  <a 
    role="button" 
    id="scrollbutton" 
    class="basebutton" 
    aria-label="回到顶部">
    <i class="iconfont icon-arrowleft button-icon"></i>
  </a>

<a 
  role="button" 
  id="menubutton"
  aria-label="menu button"
  class="basebutton">
  <i class="iconfont icon-menu button-icon"></i>
</a>
<a 
  role="button" 
  id="popbutton" 
  class="basebutton" 
  aria-label="控制中心">
  <i class="iconfont icon-expand button-icon"></i>
</a>
<a 
  role="button" 
  id="darkbutton" 
  class="basebutton darkwidget" 
  aria-label="夜色模式">
  <i class="iconfont icon-weather button-icon"></i>
</a>
<a 
  role="button" 
  id="searchbutton" 
  class="basebutton searchwidget" 
  aria-label="搜索">
  <i class="iconfont icon-search button-icon"></i>
</a> 
     
     
     
      <script>
  var addImgLayout = function () {
    var img = document.querySelectorAll('.post-content img')
    var i
    for (i = 0; i < img.length; i++) {
      var wrapper = document.createElement('a')
      wrapper.setAttribute('href', img[i].getAttribute('data-src'))
      wrapper.setAttribute('aria-label', 'illustration')
      wrapper.style.cssText =
        'width: 100%; display: flex; justify-content: center;'
      if (img[i].alt) wrapper.dataset.caption = img[i].alt
      wrapper.dataset.nolink = true
      img[i].before(wrapper)
      wrapper.append(img[i])
      var divWrap = document.createElement('div')
      divWrap.classList.add('gallery')
      wrapper.before(divWrap)
      divWrap.append(wrapper)
    }
    baguetteBox.run('.gallery')
  }
</script>
<script>
  loadScript(
    "/js/lib/lightbox/baguetteBox.min.js",
    addImgLayout
  )
</script>
 
     
     
    <script src="/js/main.js"></script> 
     
    
      <script>
        var addLazyload = function () {
          var observer = lozad('.lozad', {
            load: function (el) {
              el.srcset = el.getAttribute('data-src')
            },
            loaded: function (el) {
              el.classList.add('loaded')
            },
          })
          observer.observe()
        }
      </script>
      <script>
        loadScript('/js/lib/lozad.min.js', addLazyload)
      </script>
    
    <script src="//instant.page/5.1.0" type="module"
      integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
    
    
  </body>
</html>
